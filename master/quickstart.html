

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quick Start &mdash; SMAC 0.10.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Manual" href="manual.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SMAC
          

          
            
            <img src="_static/SMAC3.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.10.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual.html">Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="basic_usage.html">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="options.html">Options and file formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="tae.html">Target Algorithm Evaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="psmac.html">Parallel SMAC (pSMAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html">Validation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.configspace.html">smac.configspace package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.configspace.util.html">smac.configspace.util module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.epm.html">smac.epm package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.epm.base_epm.html">smac.epm.base_epm module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.epm.base_imputor.html">smac.epm.base_imputor module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.epm.random_epm.html">smac.epm.random_epm module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.epm.rf_with_instances.html">smac.epm.rf_with_instances module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.epm.rfr_imputator.html">smac.epm.rfr_imputator module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.epm.uncorrelated_mo_rf_with_instances.html">smac.epm.uncorrelated_mo_rf_with_instances module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.facade.html">smac.facade package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.facade.epils_facade.html">smac.facade.epils_facade module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.facade.func_facade.html">smac.facade.func_facade module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.facade.roar_facade.html">smac.facade.roar_facade module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.facade.smac_facade.html">smac.facade.smac_facade module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.initial_design.html">smac.initial_design package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.initial_design.default_configuration_design.html">smac.initial_design.default_configuration_design module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.initial_design.initial_design.html">smac.initial_design.initial_design module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.initial_design.multi_config_initial_design.html">smac.initial_design.multi_config_initial_design module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.initial_design.random_configuration_design.html">smac.initial_design.random_configuration_design module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.initial_design.single_config_initial_design.html">smac.initial_design.single_config_initial_design module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.intensification.html">smac.intensification package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.intensification.intensification.html">smac.intensification.intensification module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.optimizer.html">smac.optimizer package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.optimizer.acquisition.html">smac.optimizer.acquisition module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.optimizer.ei_optimization.html">smac.optimizer.ei_optimization module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.optimizer.epils.html">smac.optimizer.epils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.optimizer.objective.html">smac.optimizer.objective module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.optimizer.pSMAC.html">smac.optimizer.pSMAC module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.optimizer.random_configuration_chooser.html">smac.optimizer.random_configuration_chooser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.optimizer.smbo.html">smac.optimizer.smbo module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.runhistory.html">smac.runhistory package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.runhistory.runhistory.html">smac.runhistory.runhistory module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.runhistory.runhistory2epm.html">smac.runhistory.runhistory2epm module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.scenario.html">smac.scenario package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.scenario.scenario.html">smac.scenario.scenario module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.stats.html">smac.stats package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.stats.stats.html">smac.stats.stats module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.tae.html">smac.tae package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.tae.execute_func.html">smac.tae.execute_func module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.tae.execute_ta_run.html">smac.tae.execute_ta_run module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.tae.execute_ta_run_aclib.html">smac.tae.execute_ta_run_aclib module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.tae.execute_ta_run_old.html">smac.tae.execute_ta_run_old module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.utils.html">smac.utils package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.utils.io.html">smac.utils.io package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apidoc/smac.utils.io.cmd_reader.html">smac.utils.io.cmd_reader module</a></li>
<li class="toctree-l4"><a class="reference internal" href="apidoc/smac.utils.io.input_reader.html">smac.utils.io.input_reader module</a></li>
<li class="toctree-l4"><a class="reference internal" href="apidoc/smac.utils.io.output_directory.html">smac.utils.io.output_directory module</a></li>
<li class="toctree-l4"><a class="reference internal" href="apidoc/smac.utils.io.output_writer.html">smac.utils.io.output_writer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="apidoc/smac.utils.io.traj_logging.html">smac.utils.io.traj_logging module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.utils.constants.html">smac.utils.constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.utils.duplicate_filter_logging.html">smac.utils.duplicate_filter_logging module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.utils.logging.html">smac.utils.logging module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.utils.merge_foreign_data.html">smac.utils.merge_foreign_data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.utils.test_helpers.html">smac.utils.test_helpers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.utils.util_funcs.html">smac.utils.util_funcs module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apidoc/smac.utils.validate.html">smac.utils.validate module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apidoc/smac.smac_cli.html">smac.smac_cli module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">F.A.Q.</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SMAC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Quick Start</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/quickstart.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quick-start">
<h1>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h1>
<p>If you have not installed <em>SMAC</em> yet take a look at the <a class="reference external" href="installation.html">installation instructions</a> and make sure that all the requirements are fulfilled.
Examples to illustrate the usage of <em>SMAC</em> - either by reading in a scenario file, or by directly using <em>SMAC</em> in Python - are provided in the examples-folder.</p>
<p>To get started, we will walk you through a few examples.</p>
<ul class="simple">
<li><p>First, we explain the basic usage of <em>SMAC</em> by optimizing the <a class="reference internal" href="#branin-example">Branin</a>-function as a toy example.</p></li>
<li><p>Second, we explain the usage of <em>SMAC</em> within Python by optimizing a <a class="reference internal" href="#svm-example">Support Vector Machine</a>.</p></li>
<li><p>Third, we show a real-world example, using an algorithm-wrapper to optimize the <a class="reference internal" href="#spear-example">SPEAR SAT-solver</a>.</p></li>
</ul>
<div class="section" id="branin">
<span id="branin-example"></span><h2>Branin<a class="headerlink" href="#branin" title="Permalink to this headline">¶</a></h2>
<p>First of, we’ll demonstrate the usage of <em>SMAC</em> on the minimization of a standard 2-dimensional continuous test function (<a class="reference external" href="https://www.sfu.ca/~ssurjano/branin.html">Branin</a>).
This example aims to explain the basic usage of <em>SMAC</em>. There are different ways to use <em>SMAC</em>:</p>
<div class="section" id="f-min-wrapper">
<h3>f_min-wrapper<a class="headerlink" href="#f-min-wrapper" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to use <em>SMAC</em> is to use the <a class="reference external" href="apidoc/smac.facade.func_facade.html#smac.facade.func_facade.fmin_smac">f_min SMAC wrapper</a>. It is
implemented in <cite>examples/branin/branin_fmin.py</cite> and requires no extra files. We
import the fmin-function and the Branin-function:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">branin</span> <span class="k">import</span> <span class="n">branin</span>
<span class="kn">from</span> <span class="nn">smac.facade.func_facade</span> <span class="k">import</span> <span class="n">fmin_smac</span>
</pre></div>
</td></tr></table></div>
<p>And run the f_min-function:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    <span class="n">x</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">fmin_smac</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">branin</span><span class="p">,</span>  <span class="c1"># function</span>
                           <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># default configuration</span>
                           <span class="n">bounds</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)],</span>  <span class="c1"># limits</span>
                           <span class="n">maxfun</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>   <span class="c1"># maximum number of evaluations</span>
                           <span class="n">rng</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>        <span class="c1"># random seed</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimum at </span><span class="si">{}</span><span class="s2"> with cost of </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cost</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>This way, you can optimize a blackbox-function with minimal effort. However, to
use all of <em>SMAC’s</em> capability, a <a class="reference external" href="options.html#scenario">scenario</a> object should be used.</p>
</div>
<div class="section" id="command-line">
<h3>Command line<a class="headerlink" href="#command-line" title="Permalink to this headline">¶</a></h3>
<p>A more evolved example can be found in <code class="docutils literal notranslate"><span class="pre">examples/branin/</span></code>. In this directory you can find
a wrapper <code class="docutils literal notranslate"><span class="pre">cmdline_wrapper.py</span></code>, a scenario-file <code class="docutils literal notranslate"><span class="pre">scenario.txt</span></code>, and a
<em>PCS</em>-file <code class="docutils literal notranslate"><span class="pre">param_config_space.pcs</span></code>.
To run the example scenario, change into the root directory of <em>SMAC</em> and type the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> examples/branin
python ../../scripts/smac --scenario scenario.txt
</pre></div>
</div>
<p>The Python command runs <em>SMAC</em> with the specified scenario. The scenario file consists of the following lines:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">python</span> <span class="n">cmdline_wrapper</span><span class="o">.</span><span class="n">py</span>
<span class="n">paramfile</span> <span class="o">=</span> <span class="n">param_config_space</span><span class="o">.</span><span class="n">pcs</span>
<span class="n">run_obj</span> <span class="o">=</span> <span class="n">quality</span>
<span class="n">runcount_limit</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">deterministic</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div></blockquote>
<p>The <strong>algo</strong> parameter specifies how <em>SMAC</em> calls the target algorithm to be optimized.
This is further explained in the chapter about the <a class="reference external" href="tae.html">Target Algorithm Evaluator (TAE)</a>.
An algorithm call by <em>SMAC</em> is of the following format:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&lt;algo&gt; &lt;instance&gt; &lt;instance specific&gt; &lt;cutoff time&gt; &lt;runlength&gt; &lt;seed&gt; &lt;algorithm parameters&gt;
python branin.py <span class="m">0</span> <span class="m">0</span> <span class="m">999999999</span>.0 <span class="m">0</span> <span class="m">1148756733</span> -x1 -1.1338595629 -x2 <span class="m">13</span>.8770222718
</pre></div>
</div>
</div></blockquote>
<p>The <strong>paramfile</strong> parameter tells <em>SMAC</em> which Parameter Configuration Space (<a class="reference external" href="options.html#paramcs">PCS</a>)-file to use. This file contains a list of the algorithm’s parameters, their domains and default values:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x2</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">]</span>  <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>x1 and x2 are both continuous parameters. x1 can take any real value in the range [-5, 10], x2 in the range [0, 15] and both have the default value 0.</p>
</div></blockquote>
<p>The <strong>run_obj</strong> parameter specifies what <em>SMAC</em> is supposed to <strong>optimize</strong>. Here we optimize solution quality.</p>
<p>The <strong>runcount_limit</strong> specifies the maximum number of algorithm calls.</p>
<p><em>SMAC</em> reads the results from the command line output. The wrapper returns the
results of the algorithm in a specific format:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Result <span class="k">for</span> SMAC: &lt;STATUS&gt;, &lt;running time&gt;, &lt;runlength&gt;, &lt;quality&gt;, &lt;seed&gt;, &lt;instance-specifics&gt;
Result <span class="k">for</span> SMAC: SUCCESS, <span class="m">0</span>, <span class="m">0</span>, <span class="m">48</span>.948190, <span class="m">1148756733</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">The second line is the result of the above listed algorithm call.</div>
<div class="line"><em>STATUS:</em> can be either <em>SUCCESS</em>, <em>CRASHED</em>, <em>SAT</em>, <em>UNSAT</em>, <em>TIMEOUT</em></div>
<div class="line"><em>running time:</em> is the measured running time for an algorithm call</div>
<div class="line"><em>runlength:</em> is the number of steps needed to find a solution</div>
<div class="line"><em>quality:</em> the solution quality</div>
<div class="line"><em>seed:</em> the seed that was used with the algorithm call</div>
<div class="line"><em>instance-specifics:</em> additional information</div>
</div>
</div></blockquote>
<p><em>SMAC</em> will terminate with the following output:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>INFO:intensifier:Updated estimated error of incumbent on <span class="m">122</span> runs: <span class="m">0</span>.5063
DEBUG:root:Remaining budget: inf <span class="o">(</span>wallclock<span class="o">)</span>, inf <span class="o">(</span>ta costs<span class="o">)</span>, -6.000000 <span class="o">(</span>target runs<span class="o">)</span>
INFO:Stats:##########################################################
INFO:Stats:Statistics:
INFO:Stats:#Target algorithm runs: <span class="m">506</span>
INFO:Stats:Used wallclock time: <span class="m">44</span>.00 sec
INFO:Stats:Used target algorithm runtime: <span class="m">0</span>.00 sec
INFO:Stats:##########################################################
INFO:SMAC:Final Incumbent: Configuration:
  x1, Value: <span class="m">9</span>.556406137303922
  x2, Value: <span class="m">2</span>.429138598022513
</pre></div>
</div>
</div></blockquote>
<p>Furthermore, <em>SMACs</em> trajectory and runhistory will be stored in <code class="docutils literal notranslate"><span class="pre">branin/</span></code>.</p>
</div>
</div>
<div class="section" id="using-smac-in-python-svm">
<span id="svm-example"></span><h2>Using <em>SMAC</em> in Python: SVM<a class="headerlink" href="#using-smac-in-python-svm" title="Permalink to this headline">¶</a></h2>
<p>To explain the use of <em>SMAC</em> within Python, let’s look at a real-world example,
optimizing the hyperparameters of a Support Vector Machine (SVM) trained on the widely known <a class="reference external" href="https://en.wikipedia.org/wiki/Iris_flower_data_set">IRIS-dataset</a>.
This example is located in <code class="code docutils literal notranslate"><span class="pre">examples/svm.py</span></code>.</p>
<p>To use <em>SMAC</em> directly with Python, we first import the necessary modules</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">svm</span><span class="p">,</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">cross_val_score</span>

<span class="c1"># Import ConfigSpace and different types of parameters</span>
<span class="kn">from</span> <span class="nn">smac.configspace</span> <span class="k">import</span> <span class="n">ConfigurationSpace</span>
<span class="kn">from</span> <span class="nn">ConfigSpace.hyperparameters</span> <span class="k">import</span> <span class="n">CategoricalHyperparameter</span><span class="p">,</span> \
    <span class="n">UniformFloatHyperparameter</span><span class="p">,</span> <span class="n">UniformIntegerHyperparameter</span>
<span class="kn">from</span> <span class="nn">ConfigSpace.conditions</span> <span class="k">import</span> <span class="n">InCondition</span>

<span class="c1"># Import SMAC-utilities</span>
<span class="kn">from</span> <span class="nn">smac.tae.execute_func</span> <span class="k">import</span> <span class="n">ExecuteTAFuncDict</span>
<span class="kn">from</span> <span class="nn">smac.scenario.scenario</span> <span class="k">import</span> <span class="n">Scenario</span>
<span class="kn">from</span> <span class="nn">smac.facade.smac_facade</span> <span class="k">import</span> <span class="n">SMAC</span>
</pre></div>
</td></tr></table></div>
<dl class="simple">
<dt>We import the <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html">SVM from Scikit-Learn</a>,</dt><dd><p>different hyperparameter types, the ConfigurationSpace, and the objects we need from <em>SMAC</em>.</p>
</dd>
</dl>
<p>The ConfigurationSpace is used to define the hyperparameters we want to optimize as well as
their domains. Possible hyperparameter types are floats, integers and categorical parameters.</p>
<p>We optimize a SVM with the hyperparameters <em>kernel</em>, <em>C</em>, <em>gamma</em>, <em>coef0</em>, <em>degree</em> and <em>shrinking</em>, which
are further explained in the documentation of sklearn. Note that modifying <em>C</em> can
quickly lead to overfitting, which is why we use cross-validation to evaluate
the configuration.</p>
<p>Let’s start by creating a ConfigSpace-object and adding the first hyperparameter: the choice of
the kernel.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>60
61
62
63
64
65</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Build Configuration Space which defines all parameters and their ranges</span>
<span class="n">cs</span> <span class="o">=</span> <span class="n">ConfigurationSpace</span><span class="p">()</span>

<span class="c1"># We define a few possible types of SVM-kernels and add them as &quot;kernel&quot; to our cs</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">CategoricalHyperparameter</span><span class="p">(</span><span class="s2">&quot;kernel&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="s2">&quot;rbf&quot;</span><span class="p">,</span> <span class="s2">&quot;poly&quot;</span><span class="p">,</span> <span class="s2">&quot;sigmoid&quot;</span><span class="p">],</span> <span class="n">default_value</span><span class="o">=</span><span class="s2">&quot;poly&quot;</span><span class="p">)</span>
<span class="n">cs</span><span class="o">.</span><span class="n">add_hyperparameter</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>We can add Integers, Floats or Categoricals to the ConfigSpace-object all at
once, by passing them in a list.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>67
68
69
70</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># There are some hyperparameters shared by all kernels</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">UniformFloatHyperparameter</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">shrinking</span> <span class="o">=</span> <span class="n">CategoricalHyperparameter</span><span class="p">(</span><span class="s2">&quot;shrinking&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">],</span> <span class="n">default_value</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">)</span>
<span class="n">cs</span><span class="o">.</span><span class="n">add_hyperparameters</span><span class="p">([</span><span class="n">C</span><span class="p">,</span> <span class="n">shrinking</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>Not every kernel uses all the parameters. The sklearn-implementation of the SVM accepts all hyperparameters we want to optimize, but ignores all those incompatible with the chosen kernel.
We can reflect this in optimization using <strong>conditions</strong> to deactivate hyperparameters that are irrelevant to the current kernel.
Deactivated hyperparameters are not considered during optimization, limiting the search-space to reasonable configurations.
This way human knowledge about the problem is introduced.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>72
73
74
75
76
77
78</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Others are kernel-specific, so we can add conditions to limit the searchspace</span>
<span class="n">degree</span> <span class="o">=</span> <span class="n">UniformIntegerHyperparameter</span><span class="p">(</span><span class="s2">&quot;degree&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>     <span class="c1"># Only used by kernel poly</span>
<span class="n">coef0</span> <span class="o">=</span> <span class="n">UniformFloatHyperparameter</span><span class="p">(</span><span class="s2">&quot;coef0&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>  <span class="c1"># poly, sigmoid</span>
<span class="n">cs</span><span class="o">.</span><span class="n">add_hyperparameters</span><span class="p">([</span><span class="n">degree</span><span class="p">,</span> <span class="n">coef0</span><span class="p">])</span>
<span class="n">use_degree</span> <span class="o">=</span> <span class="n">InCondition</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">degree</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;poly&quot;</span><span class="p">])</span>
<span class="n">use_coef0</span> <span class="o">=</span> <span class="n">InCondition</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">coef0</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;poly&quot;</span><span class="p">,</span> <span class="s2">&quot;sigmoid&quot;</span><span class="p">])</span>
<span class="n">cs</span><span class="o">.</span><span class="n">add_conditions</span><span class="p">([</span><span class="n">use_degree</span><span class="p">,</span> <span class="n">use_coef0</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>Conditions can be used for various reasons. The <cite>gamma</cite>-hyperparameter for
example can be set to “auto” or to a fixed float-value. We introduce a hyperparameters
that is only activated if <cite>gamma</cite> is not set to “auto”.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>80
81
82
83
84
85
86
87
88</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># This also works for parameters that are a mix of categorical and values from a range of numbers</span>
<span class="c1"># For example, gamma can be either &quot;auto&quot; or a fixed float</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="n">CategoricalHyperparameter</span><span class="p">(</span><span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="n">default_value</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>  <span class="c1"># only rbf, poly, sigmoid</span>
<span class="n">gamma_value</span> <span class="o">=</span> <span class="n">UniformFloatHyperparameter</span><span class="p">(</span><span class="s2">&quot;gamma_value&quot;</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cs</span><span class="o">.</span><span class="n">add_hyperparameters</span><span class="p">([</span><span class="n">gamma</span><span class="p">,</span> <span class="n">gamma_value</span><span class="p">])</span>
<span class="c1"># We only activate gamma_value if gamma is set to &quot;value&quot;</span>
<span class="n">cs</span><span class="o">.</span><span class="n">add_condition</span><span class="p">(</span><span class="n">InCondition</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">gamma_value</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]))</span>
<span class="c1"># And again we can restrict the use of gamma in general to the choice of the kernel</span>
<span class="n">cs</span><span class="o">.</span><span class="n">add_condition</span><span class="p">(</span><span class="n">InCondition</span><span class="p">(</span><span class="n">child</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rbf&quot;</span><span class="p">,</span> <span class="s2">&quot;poly&quot;</span><span class="p">,</span> <span class="s2">&quot;sigmoid&quot;</span><span class="p">]))</span>
</pre></div>
</td></tr></table></div>
<p>Of course we also define a function to evaluate the configured SVM on the IRIS-dataset.
Some options, such as the <em>kernel</em> or <em>C</em>, can be passed directly.
Others, such as <em>gamma</em>, need to be translated before the call to the SVM.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">svm_from_cfg</span><span class="p">(</span><span class="n">cfg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Creates a SVM based on a configuration and evaluates it on the</span>
<span class="sd">    iris-dataset using cross-validation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    cfg: Configuration (ConfigSpace.ConfigurationSpace.Configuration)</span>
<span class="sd">        Configuration containing the parameters.</span>
<span class="sd">        Configurations are indexable!</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    A crossvalidated mean score for the svm on the loaded data-set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># For deactivated parameters, the configuration stores None-values.</span>
    <span class="c1"># This is not accepted by the SVM, so we remove them.</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="p">:</span> <span class="n">cfg</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cfg</span> <span class="k">if</span> <span class="n">cfg</span><span class="p">[</span><span class="n">k</span><span class="p">]}</span>
    <span class="c1"># We translate boolean values:</span>
    <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;shrinking&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;shrinking&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span> <span class="k">else</span> <span class="kc">False</span>
    <span class="c1"># And for gamma, we set it to a fixed value or to &quot;auto&quot; (if used)</span>
    <span class="k">if</span> <span class="s2">&quot;gamma&quot;</span> <span class="ow">in</span> <span class="n">cfg</span><span class="p">:</span>
        <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;gamma_value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;value&quot;</span> <span class="k">else</span> <span class="s2">&quot;auto&quot;</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;gamma_value&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Remove &quot;gamma_value&quot;</span>

    <span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="o">**</span><span class="n">cfg</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>  <span class="c1"># Minimize!</span>
</pre></div>
</td></tr></table></div>
<p>We need a Scenario-object to configure the optimization process.
We provide a <a class="reference external" href="options.html#scenario">list of possible options</a> in the scenario.</p>
<p>The initialization of a scenario in the code uses the same keywords as a
scenario-file, which we used in the Branin example.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>91
92
93
94
95
96</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Scenario object</span>
<span class="n">scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">({</span><span class="s2">&quot;run_obj&quot;</span><span class="p">:</span> <span class="s2">&quot;quality&quot;</span><span class="p">,</span>   <span class="c1"># we optimize quality (alternatively runtime)</span>
                     <span class="s2">&quot;runcount-limit&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>  <span class="c1"># maximum function evaluations</span>
                     <span class="s2">&quot;cs&quot;</span><span class="p">:</span> <span class="n">cs</span><span class="p">,</span>               <span class="c1"># configuration space</span>
                     <span class="s2">&quot;deterministic&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
                     <span class="p">})</span>
</pre></div>
</td></tr></table></div>
<p>Now we’re ready to create a <em>SMAC</em>-instance, which handles the Bayesian
Optimization-loop and calculates the incumbent.
To automatically handle the exploration of the search space
and evaluation of the function, SMAC needs as inputs the scenario object
as well as the function.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>103
104
105
106
107
108
109
110
111
112</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Optimize, using a SMAC-object</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimizing! Depending on your machine, this might take a few minutes.&quot;</span><span class="p">)</span>
<span class="n">smac</span> <span class="o">=</span> <span class="n">SMAC</span><span class="p">(</span><span class="n">scenario</span><span class="o">=</span><span class="n">scenario</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">),</span>
        <span class="n">tae_runner</span><span class="o">=</span><span class="n">svm_from_cfg</span><span class="p">)</span>

<span class="n">incumbent</span> <span class="o">=</span> <span class="n">smac</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>

<span class="n">inc_value</span> <span class="o">=</span> <span class="n">svm_from_cfg</span><span class="p">(</span><span class="n">incumbent</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimized Value: </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">inc_value</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>We start the optimization loop.</p>
<p>Internally SMAC keeps track of the number of algorithm calls and the remaining time budget via a Stats object.</p>
<p>After successful execution of the optimization loop the Stats object outputs the result of the loop.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>INFO:smac.stats.stats.Stats:##########################################################
INFO:smac.stats.stats.Stats:Statistics:
INFO:smac.stats.stats.Stats:#Incumbent changed: <span class="m">88</span>
INFO:smac.stats.stats.Stats:#Target algorithm runs: <span class="m">200</span> / <span class="m">200</span>.0
INFO:smac.stats.stats.Stats:Used wallclock time: <span class="m">41</span>.73 / inf sec
INFO:smac.stats.stats.Stats:Used target algorithm runtime: <span class="m">17</span>.44 / inf sec
INFO:smac.stats.stats.Stats:##########################################################
INFO:smac.facade.smac_facade.SMAC:Final Incumbent: Configuration:
  C, Value: <span class="m">357</span>.4171743725004
  coef0, Value: <span class="m">9</span>.593372746957046
  degree, Value: <span class="m">1</span>
  gamma, Value: <span class="s1">&#39;value&#39;</span>
  gamma_value, Value: <span class="m">0</span>.0029046235175726105
  kernel, Value: <span class="s1">&#39;poly&#39;</span>
  shrinking, Value: <span class="s1">&#39;false&#39;</span>
</pre></div>
</div>
<p>We further query the target function at the incumbent, using the function evaluator
so that as final output we can see the error value of the incumbent.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Optimized Value: <span class="m">0</span>.02
</pre></div>
</div>
<p>As a bonus, we can validate our results. This is more useful when optimizing on
instances, but we include the code so it is easily applicable for any usecase.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>115
116
117
118
119</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># We can also validate our results (though this makes a lot more sense with instances)</span>
<span class="n">smac</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">config_mode</span><span class="o">=</span><span class="s1">&#39;inc&#39;</span><span class="p">,</span>      <span class="c1"># We can choose which configurations to evaluate</span>
              <span class="c1">#instance_mode=&#39;train+test&#39;,  # Defines what instances to validate</span>
              <span class="n">repetitions</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>        <span class="c1"># Ignored, unless you set &quot;deterministic&quot; to &quot;false&quot; in line 95</span>
              <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>               <span class="c1"># How many cores to use in parallel for optimization</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="spear-qcp">
<span id="spear-example"></span><h2>Spear-QCP<a class="headerlink" href="#spear-qcp" title="Permalink to this headline">¶</a></h2>
<p>For this example we use <em>SMAC</em> to optimize the runtime required by the SAT solver <a class="reference external" href="http://www.domagoj-babic.com/index.php/ResearchProjects/Spear">Spear</a>
to solve a small subset of the QCP-dataset.</p>
<p>In <em>SMACs</em> root-directory type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> examples/spear_qcp <span class="o">&amp;&amp;</span> ls -l
</pre></div>
</div>
<p>In this folder you see the following files and directories:</p>
<ul>
<li><p><strong>features.txt</strong>:</p>
<blockquote>
<div><p>The <a class="reference external" href="options.html#feature">feature file</a> contains the features for each instance in a csv-format.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 31%" />
<col style="width: 31%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>instance</p></th>
<th class="head"><p>name of feature 1</p></th>
<th class="head"><p>name of feature 2</p></th>
<th class="head"><p>…</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name of instance 1</p></td>
<td><p>value of feature 1</p></td>
<td><p>value of feature 2</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><dl class="simple">
<dt><strong>instances.txt</strong></dt><dd><p>The <a class="reference external" href="options.html#instance">instance file</a> contains the names of all instances one might want to consider during the optimization process.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>scenario.txt</strong></dt><dd><p>The <a class="reference external" href="options.html#scenario">scenario</a> file contains all the necessary information about the configuration scenario at hand.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">python3</span> <span class="o">-</span><span class="n">u</span> <span class="o">./</span><span class="n">target_algorithm</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">SATCSSCWrapper</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">mem</span><span class="o">-</span><span class="n">limit</span> <span class="mi">1024</span> <span class="o">--</span><span class="n">script</span> <span class="o">./</span><span class="n">target_algorithm</span><span class="o">/</span><span class="n">spear</span><span class="o">-</span><span class="n">python</span><span class="o">/</span><span class="n">spearCSSCWrapper</span><span class="o">.</span><span class="n">py</span>
<span class="n">paramfile</span> <span class="o">=</span> <span class="o">./</span><span class="n">target_algorithm</span><span class="o">/</span><span class="n">spear</span><span class="o">-</span><span class="n">python</span><span class="o">/</span><span class="n">spear</span><span class="o">-</span><span class="n">params</span><span class="o">-</span><span class="n">mixed</span><span class="o">.</span><span class="n">pcs</span>
<span class="n">execdir</span> <span class="o">=</span> <span class="o">.</span>
<span class="n">deterministic</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">run_obj</span> <span class="o">=</span> <span class="n">runtime</span>
<span class="n">overall_obj</span> <span class="o">=</span> <span class="n">PAR10</span>
<span class="n">cutoff_time</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">wallclock</span><span class="o">-</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">instance_file</span> <span class="o">=</span> <span class="n">instances</span><span class="o">.</span><span class="n">txt</span>
<span class="n">feature_file</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>For this example the following options are used:</p>
<ul>
<li><p><em>algo:</em></p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -u ./target_algorithm/scripts/SATCSSCWrapper.py --mem-limit <span class="m">1024</span> --script ./target_algorithm/spear-python/spearCSSCWrapper.py
</pre></div>
</div>
<p>This specifies the wrapper that <em>SMAC</em> executes with a pre-specified syntax in order to evaluate the algorithm to be optimized.
This wrapper script takes an instantiation of the parameters as input, runs the algorithm with these parameters, and returns
the cost of running the algorithm; since every algorithm has a different input and output format, this wrapper acts as an interface between the
algorithm and <em>SMAC</em>, which executes the wrapper through a command line call.</p>
<p>An example call would look something like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&lt;algo&gt; &lt;instance&gt; &lt;instance specifics&gt; &lt;cutoff time&gt; &lt;runlength&gt; &lt;seed&gt; &lt;algorithm parameters&gt;
</pre></div>
</div>
<p>For <em>SMAC</em> to be able to interpret the results of the algorithm run, the wrapper returns the results of the algorithm run as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>STATUS, running time, runlength, quality, seed, instance-specifics
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><em>paramfile:</em></p>
<blockquote>
<div><p>This parameter specifies which pcs-file to use and where it is located.</p>
<p>The PCS-file specifies the Parameter Configuration Space file, which lists the algorithm’s parameters, their domains, and default values (one per line)</p>
<p>In this example we are dealing with 26 parameters of which 12 are categorical and 14 are continuous. Out of these 26
parameters, 9 parameters are conditionals (they are only active if their parent parameter takes on a certain value).</p>
</div></blockquote>
</li>
<li><p><em>execdir:</em> Specifies the directory in which the target algorithm will be run.</p></li>
<li><p><em>deterministic:</em> Specifies if the target algorithm is deterministic.</p></li>
<li><p><em>run_obj:</em> This parameter tells <em>SMAC</em> what is to be optimized, i.e. running time or (solution) quality.</p></li>
<li><p><em>overall_obj:</em> Specifies how to evaluate the error values, e.g as mean or PARX.</p></li>
<li><p><em>cutoff_time:</em> The target algorithms cutoff time.</p></li>
<li><p><em>wallclock-limit:</em> This parameter is used to give the time budget for the configuration task in seconds.</p></li>
<li><p><em>instance_file:</em> See instances.txt above.</p></li>
<li><p><em>feature_file:</em> See features.txt above.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>run.sh</strong></dt><dd><p>A shell script calling <em>SMAC</em> with the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">../../scripts/smac</span> <span class="pre">--scenario</span> <span class="pre">scenario.txt</span> <span class="pre">--verbose</span> <span class="pre">DEBUG</span></code></p>
<p>This runs <em>SMAC</em> with the scenario options specified in the scenario.txt file.</p>
</dd>
</dl>
</li>
<li><p><strong>target_algorithms</strong> contains the wrapper and the executable for Spear.</p></li>
<li><p><strong>instances</strong> folder contains the instances on which <em>SMAC</em> will configure Spear.</p></li>
</ul>
<p>To run the example type one of the two commands below into a terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash run.sh
python ../../scripts/smac --scenario scenario.txt
</pre></div>
</div>
<p><em>SMAC</em> will run for a few seconds and generate a lot of logging output.
After <em>SMAC</em> finished the configuration process you’ll get some final statistics about the configuration process:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>INFO:    <span class="c1">##########################################################</span>
INFO:    Statistics:
INFO:    <span class="c1">#Incumbent changed: 2</span>
INFO:    <span class="c1">#Target algorithm runs: 17 / inf</span>
INFO:    Used wallclock time: <span class="m">35</span>.38 / <span class="m">30</span>.00 sec
INFO:    Used target algorithm runtime: <span class="m">20</span>.10 / inf sec
INFO:    <span class="c1">##########################################################</span>
INFO:    Final Incumbent: Configuration:
  sp-clause-activity-inc, Value: <span class="m">0</span>.9846527087294622
  sp-clause-decay, Value: <span class="m">1</span>.1630090545101102
  sp-clause-del-heur, Value: <span class="s1">&#39;0&#39;</span>
  sp-first-restart, Value: <span class="m">30</span>
  sp-learned-clause-sort-heur, Value: <span class="s1">&#39;10&#39;</span>
  sp-learned-clauses-inc, Value: <span class="m">1</span>.2739749314202675
  sp-learned-size-factor, Value: <span class="m">0</span>.8355014264152971
  sp-orig-clause-sort-heur, Value: <span class="s1">&#39;1&#39;</span>
  sp-phase-dec-heur, Value: <span class="s1">&#39;0&#39;</span>
  sp-rand-phase-dec-freq, Value: <span class="s1">&#39;0.01&#39;</span>
  sp-rand-phase-scaling, Value: <span class="m">0</span>.3488055907688382
  sp-rand-var-dec-freq, Value: <span class="s1">&#39;0.05&#39;</span>
  sp-rand-var-dec-scaling, Value: <span class="m">0</span>.46427056372562864
  sp-resolution, Value: <span class="s1">&#39;0&#39;</span>
  sp-restart-inc, Value: <span class="m">1</span>.7510945705535836
  sp-update-dec-queue, Value: <span class="s1">&#39;1&#39;</span>
  sp-use-pure-literal-rule, Value: <span class="s1">&#39;0&#39;</span>
  sp-var-activity-inc, Value: <span class="m">0</span>.9000377944957962
  sp-var-dec-heur, Value: <span class="s1">&#39;14&#39;</span>
  sp-variable-decay, Value: <span class="m">1</span>.8292433459523076
</pre></div>
</div>
<p>The statistics further show the used wallclock time, target algorithm running time and the number of executed target algorithm runs,
and the corresponding budgets—here we exhausted the wallclock time budget.</p>
<p>The directory in which you invoked <em>SMAC</em> now contains a new folder called <strong>SMAC3-output_YYYY-MM-DD_HH:MM:SS</strong>.
The .json file contains the information about the target algorithms <em>SMAC</em> just executed. In this file you can see the <em>status</em> of the algorithm run, <em>misc</em>, the <em>instance</em> on which the algorithm was evaluated, which <em>seed</em> was used, how much <em>time</em> the algorithm needed and with which <em>configuration</em> the algorithm was run.
In the folder <em>SMAC</em> generates a file for the runhistory, and two files for the trajectory.</p>
</div>
<div class="section" id="hydra-on-spear-qcp">
<span id="hydra-example"></span><h2>Hydra on Spear-QCP<a class="headerlink" href="#hydra-on-spear-qcp" title="Permalink to this headline">¶</a></h2>
<p>For this example we use <em>Hydra</em> to build a portfolio on the same example data presented in <a class="reference internal" href="#spear-example">Spear-QCP</a>.
Hydra is a portfolio builder that aims to build a portfolio by iteratively adding complementary configurations to the
already existing portfolio. To select these complementary configurations <em>Hydra</em> compares new configurations to the
portfolio and only considers configurations that improve the portfolio performance.
In the first iteration Hydra runs standard <em>SMAC</em> to determine a well performing configuration
across all instances as a starting point for the portfolio. In following iterations <em>Hydra</em> adds one configuration that
improves the portfolio performance.</p>
<p>To run Hydra for three iterations you can run the following code in the spear-qcp example folder.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">../../scripts/smac</span> <span class="pre">--scenario</span> <span class="pre">scenario.txt</span> <span class="pre">--verbose</span> <span class="pre">DEBUG</span> <span class="pre">--mode</span> <span class="pre">Hydra</span> <span class="pre">--hydra_iterations</span> <span class="pre">3</span></code></p>
</div></blockquote>
<p>As the individual SMAC scenario takes 30 seconds to run Hydra will run for ~90 seconds on this example.
You will see the same output to the terminal as with standard SMAC. In the folder where you executed the above command,
you will find a <em>hydra-output-yyy-mm-dd_hh:mm:ss_xyz</em> folder. This folder contains the results of all three performed
SMAC runs, as well as the resulting portfolio (as pkl file).</p>
<p>The resulting portfolio can be used with any algorithm selector such as <a class="reference external" href="https://github.com/mlindauer/AutoFolio">AutoFolio</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="manual.html" class="btn btn-neutral float-right" title="Manual" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2019, Marius Lindauer, Matthias Feurer, Katharina Eggensperger, Joshua Marben, André Biedenkapp, Aaron Klein, Stefan Falkner and Frank Hutter

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>